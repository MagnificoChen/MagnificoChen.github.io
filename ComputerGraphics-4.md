<head>
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async>
</script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [["$", "$"], ["\\(", "\\)"]],
            displayMath: [["$$", "$$"], ["\\[", "\\]"]],
            }
        });
    </script>
</head>

# 第十章 表面着色

**要使对象看起来更真实，使用着色即可，也就是使用光来“绘制”表面。本章将介绍最常见的启发式的着色方法。前两个是漫反射和冯-着色，它们是在 20 世纪 70 年代开发的，在大多数图形库中都可以使用。最后一种是艺术着色，它使用艺术惯例为对象指定颜色。这会让人想起工图，在许多应用中都挺有用的。**

## 10.1 漫反射着色

世界上许多对象的表面，外观可以简单的描述为“无光泽”，这说明该物体没有光泽。例如纸张、未加工的木材和干燥的未抛光的石头。在很大程度上，这样的对象的颜色不会随着视点的变化而变。例如，如果你盯着一张纸上的一个点，你的人在移动，但你的目光固定在该点上，该点的颜色将不会改变。这样的无光泽物体可以被视为 _兰伯特对象_ 。本节会讨论如何实现这类对象的着色。一个关键点是，在应用透视变换后，本章中的所有公式都应在世界坐标中进行计算，而不是在扭曲坐标中进行计算。否则，法线之间的角度将更改，造成不准确的着色。

### 10.1.1 兰伯特光照模型

兰伯特对象的着色遵循兰伯特余弦定律，这个定律规定了曲面的颜色 $c$ 与曲面法线和光源方向之间的夹角的余弦成正比：

$$c \propto \cos \theta$$

向量形式是：

$$c \propto {\rm \textbf{n}} \cdot {\rm \textbf{l}} $$

[图 10.1] 展示了 ${\rm \textbf{n}}$ 和 ${\rm \textbf{l}}$ 的位置。因此，曲面上的颜色将根据曲面法线和灯光方向之间角度的余弦而变化。但我们通常认为向量 ${\rm \textbf{l}}$ 不依赖于对象在世界中的位置。也就是将光源视作无限远。这种远光称为 _平行光_ ，因为光源位置只通过方向指定。

通过改变光源的强度或表面的反射率，可以使物体表面变亮或变暗。漫反射系数 $c_r$ 表示表面反射光线的程度。对于不同的颜色组件，该系数也是不同的。例如，如果表面反射红色入射光的比例高于蓝色入射光的比例，那么这个表面就是红色。如果我们假设表面颜色与从表面反射的光成比例，则漫反射光就应该表示为 **RGB 颜色** ：

$$c \propto c_r{\rm \textbf{n}} \cdot {\rm \textbf{l}}$$

上面这个方程的右边是一个 RGB 颜色，每个 RGB 分量的值区间是 $[0,1]$ 。我们一般希望添加灯光强度的效果的同时，将 RGB 组件的值范围保持在范围 $[0,1]$ 内，这时候就可以添加一个 RGB 光照强度项 $c_l$ ，它的范围在 $[0,1]$ 内：

$$c = c_rc_l{\rm \textbf{n}} \cdot {\rm \textbf{l}}$$

这是一个很方便的写法，但它仍然可能导致 RGB 分量越界，因为向量的点积可能是负数。如果乘积为负数，那么说明物体是背对光源的，不应该收到任何光，所以我们将公式改进为：

$$c = c_rc_l{\rm max}(0,{\rm \textbf{n}} \cdot {\rm \textbf{l}})$$

或者如果你需要 _双面照明_ ，你可以使用如下公式，尽管看上去好像不太符合物理常识：

$$c = c_rc_l|{\rm \textbf{n}} \cdot {\rm \textbf{l}}|$$

### 10.1.2 环境光着色
