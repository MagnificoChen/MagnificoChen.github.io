# 第十五章 曲线 *By Micheal Gleicher*

## 15.1 曲线

直观上，我们可以把曲线想象成用笔画出来的东西。曲线是笔在一段时间内画出的一组点。尽管我们想到的应该是一支笔在纸上写字（如二维空间中的曲线），但实际上，笔可以在三维空间中移动，画出空间的曲线。

在数学上，曲线的定义至少可以通过两种方式来理解：

1. n维空间中在某区间内产生的连续图像
2. 从一维空间到n维空间的连续映射

这两种定义都是从区间（笔沿着曲线开始画的时间区间）这一概念开始的。然而，有一个显著的区别：在第一个定义中，曲线是笔根据时间画出的点的集合（图像），而在第二个定义中，曲线是时间和这组点之间的映射。在本章中，我们用第一个定义。

曲线是无限多个点的集合。曲线上的点具有这样的特性，即任何点都有两个邻居，除了少数点只有一个邻居(端点)。有些曲线没有端点，要么是因为它们是无限的(直线)，要么是因为它们是封闭的(自环)。

因为曲线的“笔”很细(无限小)，所以很难创建填充区域。虽然我们有可能做到在空间填充曲线(通过将它们无限次折叠起来)，但我们在这里不考虑这种数学上的奇怪现象。一般来说，我们认为曲线是物体的 *轮廓* 。

我们需要解决的问题是如何指定曲线 —— 命名，以及给出曲线的一种表示，以便我们可以在计算机上绘制。对于某些曲线，命名问题很容易，因为它们的形状家喻户晓：线段、圆、圆弧等。没有“命名”形状的一般曲线有时被称为 *自由曲线* 。因为自由曲线几乎可以呈现任何形状，所以它们很难指定和特化。

有三种主要的数学方法来定义一条曲线：

1. **隐式曲线** 曲线表示通过给出一个过程来定义曲线上的点的集合，这个过程可以测试一个点是否在曲线上。通常，隐式曲线表示法由如下形式的隐函数定义：
   $$f(x,y) = 0$$
    曲线就是满足这个方程的点的集合。隐函数 $f$ 是一个标量函数(它返回一个实数)。

2. **参数曲线** 参数曲线表示提供了从 *自由参数* 到曲线上点集的映射。也就是说，这个所谓的自由参数提供了曲线上点的索引。曲线的参数形式是为自由参数值分配位置的函数。直观地讲，如果你把曲线想象成可以用笔在纸上画的轨迹，自由参数就是时间 —— 从我们 **开始画** 到 **完成曲线** 的时间。曲线的参数函数告诉我们笔在任意时刻的位置：
    $$(x,y) = {\rm\textbf{f}(t)},$$
    参数函数是一个向量函数。这个例子是一个二维曲线，所以函数的输出是一个二维向量，在三维中则是一个三维向量。

3. **生成式曲线** 生成式曲线（以及过程曲线）的表示法可以提供不属于前两类曲线上的点的过程曲线。生成曲线描述的例子包括 **细分** 和 **分形** 。

记住，曲线是点的集合。这些表示法也只是一些能让我们能获取那些点集的方法。曲线有许多不同的表示法，一条曲线可以被表示成多种形式。因此，数学家通常会小心地区分曲线和它的表示法。不过，在计算机图形学中，我们对这方面的约束比较宽松，因为我们通常只需要知道表示法，而不是曲线本身。当我们讲到“隐式曲线”时，指的要么是用隐函数表示的 **曲线** ，要么是曲线的一种表示形式： **隐函数** 。除非我们需要考虑同一曲线的不同表示，不然前面两个其实讲的是同一个东西。由于我们将在本章中讨论不同的曲线表示，这方面的描述会比较重要。当我们使用“多项式曲线”这样的术语时，我们要指的是：可以用多项式表示的 **曲线** 。

根据本章开头给出的定义，曲线必须有参数表示。然而，许多曲线有其他的表示。例如，一个圆心为原点，半径为1的二维圆可以隐式表示为：

$$f(x,y) = x^2+y^2-1=0$$

或者用参数化表示：

$$(x,y) = \mathbf{f}(t) = (\cos t, \sin t)$$

对于给定曲线，参数形式不一定是最方便的表示。事实上，曲线可能具有简单的隐式或生成式表示，但 **很难** 找到参数表示。

不同的曲线表示方式各有优缺点。例如，参数曲线更容易绘制，因为我们可以对自由参数进行采样，得到曲线上的点。一般来说，参数形式是计算机图形学中最常用的，因为它们更容易使用。我们的重点也会放在曲线的参数化表示。

### 15.1.1 参数化 与 重新参数化

> 参数化的好处是给了我们一种方便对比不同曲线的方法, 但是缺点是对曲线进行的参数化有时候会导致混乱, 这是因为曲线本身是不需要这个特殊参数的参与的(例如隐式曲线). 只看参数形式的话很多截然不同的曲线会有相同的参数形式, 这些曲线绘制出来的时形象是一样的, 但是例如在曲线内将参数写为二次幂形式, 同样参数为0.5时, 二次幂的代表的点显然与一次时代表的不同。

> 相同的曲线出现了不同的表达, 解决方法是给出共识让各个机器都以相同的方法选择参数, 这种为了便于定义曲线创建的参数形式称为自然参数化, 最常用的是弧长参数化, 也就是让函数沿着曲线的弧长改变, 相当于固定了函数的切线斜率。

*参数曲线* 是指在特定 **区间** 内由特定参数函数给出的曲线。更精确地说，参数曲线有一个给定的函数，它是参数区间的 **映射** 。我们发现，让参数在从 $0$ 到 $1$ 的单位间隔内进行映射会很方便。当自由参数在单位区间内变化时，我们通常用 $u$ 来表示参数。

如果我们把参数化曲线看作是用笔画的一条线，我们可以认为 $u = 0$ 是笔第一次放在纸上的时间，参数的单位是绘制曲线所需的时间 ( $u = 1$ 是曲线的终点)。

曲线可以通过将时间（区间内的参数）映射到位置的函数来指定。基本上，如果一个函数可以回答“ $u$ 时刻笔在哪里？”的问题，那它就能确定一条曲线。

如果给定一个函数 $\mathbf{f}(t)$ ，它表示区间 $[a, b]$ 上的曲线，我们可以很容易地找到一个新函数 $\mathbf{f}_2(u)$ ，它表示单位区间 $[0,1]$ 上的相同曲线。我们可以首先定义：

$$g(u) = a+(b-a)u$$

然后

$$\mathbf{f}_2(u) = \mathbf{f}(g(u))$$

这两个函数 $\mathbf{f}$ 和 $\mathbf{f}_2$ 都表示同一条曲线。然而，它们提供了不同的曲线参数化。我们将参数区间进行转换，为的是之后处理更方便。为现有曲线创建新参数化的过程称为 *重新参数化* ，从旧参数到新参数（在本例中为 $g$ ）的映射称为 *重新参数化函数* 。

如果我们通过一些参数化定义了一条曲线，那么存在无限多的其他参数化（因为我们总是可以重新参数化）。能够对曲线进行多个参数化很有用，因为它允许我们创建方便的参数化。然而，它也可能有问题，因为重新参数化后，你很难看出来两个不同的函数是否表示同一条曲线。

这个问题的本质更普遍：自由参数（或时间元素）的存在为我们的曲线表示增加了一个看不见的，潜在的未知元素。也就是说，当我们看到画好的曲线时，我们不一定知道时间是什么。这支笔可能在整个时间间隔内以恒定的速度移动，或者它可能开始很慢，然后加速。

例如，虽然 $u = 0.5$ 是参数空间的中间点，但如果笔的运动开始很慢，并在后面加速，则它对应的点就可能不是曲线的中点。考虑下面一条非常简单的曲线的表示：

$$(x,y) = \mathbf{f}(u) = (u,u)$$
$$(x,y) = \mathbf{f}(u) = (u^2,u^2)$$
$$(x,y) = \mathbf{f}(u) = (u^5,u^5)$$

这三个函数在单位区间上显然表示同一曲线。然而，当 $u$ 不为 $0$ 或 $1$ 时， $\mathbf{f}(u)$ 在这三个函数中指的是不同的点。

如果我们给出了曲线的参数化，我们可以直接使用它来说明曲线，抑或是，我们可以开发一个更方便的参数化形式。

通常，我们用 *自然参数化* 来创造一种方便确定曲线的参数化表示。这样我们就不需要知道参数沿曲线的变化速度。

如果我们提前能知道笔是 **匀速移动** 的，那么自由参数的值会变得更有意义，因为参数在区间中点的时候就是曲线的中点。因此，我们不用时间作为参数，而是用 *曲线长度* 作为参数。这种参数化称为 *弧长参数化* ，因为它们通过从沿曲线的距离(称为弧长)映射到位置的函数来定义曲线。我们经常用变量 $s$ 来表示弧长参数。

> 也就是说，速度恒定的参数曲线即是弧长参数化曲线。

从技术上讲，如果一个曲线弧长 *正切，tangent* 的大小（即参数化对参数的导数）是常数，则这样的参数化就是弧长参数化。用方程表示，

$$\left| \frac{d\mathbf{f}(s)}{ds}\right|^2 = c$$

计算一条曲线的长度是很棘手的。一般来说，它是由上述导数的积分来定义的（直观地说，导数的大小是笔沿着曲线移动的速度）。因此，给定参数 $v$ 的值，你可以计算 $s$ （沿曲线从点 $\mathbf{f}(0)$ 到点 $\mathbf{f}(v)$ 的弧长距离）是：

$$s = \int^{v}_{0} \left| \frac{d\mathbf{f}(t)}{dt}\right|^2 dt \tag{15.1}$$

其中 $\mathbf{f}(t)$ 是用自然参数化定义曲线的函数。

使用弧长参数化要求能够在给定 $s$ 的情况下解出 $t$ (方程15.1)。但是，对于我们所研究的许多类型的曲线，我们找不到它的 *闭式解* （解析解），只能找到它的数值解。

通常，我们使用变量 $u$ 来表示在单位区间内的自由参数， $s$ 来表示弧长自由参数， $t$ 来表示除前两个之外定义的自由参数。

### 15.1.2 分段参数化曲线的表示